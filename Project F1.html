<head>
    <script src="gl-matrix-min.js"></script>
    <script>
        function main() {
            canvas = document.querySelector("#glCanvas");
            canvas.addEventListener("mousedown", doMouseDown, false);
            const gl = canvas.getContext("webgl");
        
            if (gl === null) {
                alert("Unable to initialize WebGL. Your browser or machine may not support it.");
                return;
            }
        
            const vsSource = `
                attribute vec4 aVertexPosition;
                attribute vec3 aVertexNormal; // ** LIGHTING **
                attribute vec4 aVertexColor;

                uniform mat4 uNormalMatrix; // ** LIGHTING **
                uniform mat4 uModelViewMatrix;
                uniform mat4 uProjectionMatrix;

                varying lowp vec4 vColor;
                varying highp vec3 vLighting; // ** LIGHTING **

                void main(void) {
                    gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;
                    vColor = aVertexColor;

                    // Apply lighting effect // ** LIGHTING **

                    highp vec3 ambientLight = vec3(0.3, 0.3, 0.3);
                    highp vec3 directionalLightColor = vec3(1, 1, 1);
                    highp vec3 directionalVector = normalize(vec3(0.85, 0.8, 0.75));

                    highp vec4 transformedNormal = uNormalMatrix * vec4(aVertexNormal, 1.0);

                    highp float directional = max(dot(transformedNormal.xyz, directionalVector), 0.0);
                    vLighting = ambientLight + (directionalLightColor * directional);
                }
            `;

            const fsSource = `
                varying lowp vec4 vColor;
                varying highp vec3 vLighting; // ** LIGHTING **

                void main(void) {
                    gl_FragColor = vec4(vColor.rgb * vLighting, vColor.a); // ** LIGHTING **
                }
            `;

            const shaderProgram = initShaderProgram(gl, vsSource, fsSource);

            const programInfo = {
                program: shaderProgram,
                attribLocations: {
                    vertexPosition: gl.getAttribLocation(shaderProgram, 'aVertexPosition'),
                    vertexNormal: gl.getAttribLocation(shaderProgram, 'aVertexNormal'), // ** LIGHTING **
                    vertexColor: gl.getAttribLocation(shaderProgram, 'aVertexColor'),
                },
                uniformLocations: {
                    projectionMatrix: gl.getUniformLocation(shaderProgram, 'uProjectionMatrix'),
                    modelViewMatrix: gl.getUniformLocation(shaderProgram, 'uModelViewMatrix'),
                    normalMatrix: gl.getUniformLocation(shaderProgram, 'uNormalMatrix'), // ** LIGHTING **
                }
            };

            const positionsBox = [

                -1.0, -1.0,  1.0, // 0
                1.0, -1.0,  1.0, // 1
                1.0,  1.0,  1.0, // 2
                -1.0,  1.0,  1.0, // 3

                -1.0, -1.0, -1.0, // 4
                -1.0,  1.0, -1.0, // 5
                1.0,  1.0, -1.0, // 6
                1.0, -1.0, -1.0, // 7

                -1.0,  1.0, -1.0, // 8
                -1.0,  1.0,  1.0, // 9
                1.0,  1.0,  1.0, // 10
                1.0,  1.0, -1.0, // 11

                -1.0, -1.0, -1.0, // 12
                1.0, -1.0, -1.0, // 13
                1.0, -1.0,  1.0, // 14
                -1.0, -1.0,  1.0, // 15

                1.0, -1.0, -1.0, // 16
                1.0,  1.0, -1.0, // 17
                1.0,  1.0,  1.0, // 18
                1.0, -1.0,  1.0, // 19

                -1.0, -1.0, -1.0, // 20
                -1.0, -1.0,  1.0, // 21
                -1.0,  1.0,  1.0, // 22
                -1.0,  1.0, -1.0, // 23
            ];

            gl.clearColor(0.0, 0.0, 0.0, 1.0);  
            gl.clearDepth(1.0);                
            gl.enable(gl.DEPTH_TEST);          
            gl.depthFunc(gl.LEQUAL);            

            const fieldOfView = 45 * Math.PI / 180; 
            const aspect = gl.canvas.clientWidth / gl.canvas.clientHeight;
            const zNear = 0.1;
            const zFar = 100.0;
            const projectionMatrix = mat4.create();

            var cameraMatrix = mat4.perspective(projectionMatrix,
                                fieldOfView,
                                aspect,
                                zNear,
                                zFar);
  
            cameraMatrix = mat4.translate(cameraMatrix,cameraMatrix,[-cMoveX, -cMoveY, -cMoveZ]);   

            let cameraRotateDefault = 30 * 0.0174533;
            cameraMatrix = mat4.rotate(cameraMatrix,cameraMatrix,cameraRotateDefault,[0,1,0]);
                                
            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT); 


            
            //==================================================================
            //==================================================================
            let modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox, greenColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ); 

            //FrontBody
            mat4.scale(modelViewMatrix,modelViewMatrix,[1.8,0.45,1.3]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[-0.945,0,0]);
            mat4.rotateX(modelViewMatrix,modelViewMatrix,45 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //BackBody
            //colorsBuffer = initBuffers(gl, positionsBox, darkblueColors );
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.5,1,1]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[4.8,0,0]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);
            
            
            //==================================================================
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,redColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            //LongBodyleft
            mat4.scale(modelViewMatrix,modelViewMatrix,[3.5,0.37,0.1]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,-1,18.5]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);
            //longbodyright
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-37]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,greenColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            //Lowerbodyfront
            mat4.scale(modelViewMatrix,modelViewMatrix,[1.8,0.37,1.9]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[-0.945,-1,0]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);
            //Lowerbodyback
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.5,1,1]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[4.8,0,0]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,redColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            //baseBody
            mat4.scale(modelViewMatrix,modelViewMatrix,[3.5,0.05,1.9]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,-13.7,0]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);
            
            //==================================================================

            //all connect
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,greyColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            //FrontConnector 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.1,0.1,3]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[-29,-4.0,0]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //RearConnector
            mat4.translate(modelViewMatrix,modelViewMatrix,[55,0,0]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================
            
            modelViewMatrix = mat4.create(); 
            
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            var greyColors2 = [ 
            [0.6,  0.6,  0.6, 1.0],    
            [0.6,  0.6,  0.6, 1.0],    
            [0.7,  0.7,  0.7, 1.0],    
            [0.7,  0.7,  0.7, 1.0],      
            [0.8,  0.8,  0.8, 1.0],   
            [0.8,  0.8,  0.8, 1.0],   
            ];

            var colorsBuffer = initBuffers(gl,positionsBox,greyColors2);

            //RightspoilerConnector
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.1,0.7,0.1]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[30,1,12]);
            mat4.rotateY(modelViewMatrix,modelViewMatrix,45 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //LeftSpoilerConnector
            mat4.translate(modelViewMatrix,modelViewMatrix,[17,0,-17]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================
            
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-0.5]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,0.3]);

            //Fronttyre  kiri 1 
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.4,0.35,0.2]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[-7.2,-1.2,14.8]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformGrandZ); 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,45 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================
            
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);        

            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-0.5]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,0.3]);

            //Fronttyre kiri 2
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.4,0.35,0.2]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[-7.2,-1.2,14.8]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformGrandZ); 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,90 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0)

            //==================================================================
            
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-0.5]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,0.3]);

            //Fronttyre  kiri 3
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.4,0.35,0.2]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[-7.2,-1.2,14.8]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformGrandZ); 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,22.5 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-0.5]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,0.3]);

            //Fronttyre  kiri 4
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.4,0.35,0.2]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[-7.2,-1.2,14.8]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformGrandZ); 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,67.5* 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            
            //Fronttyre kanan 1
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-27.65]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================

            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);        

            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-0.5]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,0.3]);

            //fronttyre kanan 2
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.4,0.35,0.2]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[-7.2,-1.2,-12.85]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformGrandZ); 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,45 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);
            
            //==================================================================

            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);        

            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-0.5]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,0.3]);

            //fronttyre kanan 3
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.4,0.35,0.2]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[-7.2,-1.2,-12.85]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformGrandZ); 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,22.5 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================

            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);        

            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-0.5]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,0.3]);

            //fronttyre kanan 3
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.4,0.35,0.2]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[-7.2,-1.2,-12.85]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformGrandZ); 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,90 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);
            
            //==================================================================
            
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-0.5]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,0.3]);

            //backtyre kiri 1 
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.5,0.5,0.3]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[5.15,-0.9,9.7]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformGrandZ); 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,45 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //backtyre kanan 1
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-18.05]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-0.5]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,0.3]);

            //backtyre kiri 2
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.5,0.5,0.3]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[5.15,-0.9,9.7]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformGrandZ); 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,90 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //backtyre kanan 2
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-18.05]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================
            
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-0.5]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,0.3]);

            //backtyre kiri 3
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.5,0.5,0.3]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[5.15,-0.9,9.7]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformGrandZ); 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,22.5 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //backtyre kanan 3
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-18.05]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-0.5]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformChildY); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,0.3]);

            //backtyre kiri 4
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.5,0.5,0.3]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[5.15,-0.9,9.7]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,transformGrandZ); 
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,67.5 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0); 

            //backtyre kanan 4
            mat4.translate(modelViewMatrix,modelViewMatrix,[0,0,-18.05]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0); 

            //==================================================================
            
            modelViewMatrix = mat4.create(); 
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            var YellowColors2 = [
            [1.500, 0.5, 0, 0.5],
            [1.500, 0.5, 0, 0.5],
            [1.480, 0.7, 0, 1],
            [1.480, 0.7, 0, 1],
            [1.370, 0.4, 0, 1],
            [1.370, 0.4, 0, 1],
            ];

            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors2);

            //spoiler
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.5,0.05,1.9]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[6,20.1,0.005]);
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,45 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //spoiler 2
            mat4.translate(modelViewMatrix,modelViewMatrix,[4.5,4,0]); 
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //spoiler 3
            mat4.translate(modelViewMatrix,modelViewMatrix,[4.5,4,0]); 
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);
            
            //==================================================================
            
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,YellowColors2);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            //spoiler holder 
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.15,0.4,-0.015]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[20.5,2.9,0.5]);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //=====================================================================

            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,greenColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            //frontwing
            mat4.scale(modelViewMatrix,modelViewMatrix,[1,0.35,1.6]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[-3.5,-1,0]);  
            mat4.rotateY(modelViewMatrix,modelViewMatrix,45 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);
            
            //==================================================================
            
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,greyColors2);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            //exhaust
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.1,0.38,0.38]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[36,-0.2,0]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,45 * 0.0174533);
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================
            
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,greyColors2);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            //sterringConnector
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.25,0.1,0.1]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[1.3,0,0]);  
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================
            
            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,greenColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            mat4.rotateX(modelViewMatrix,modelViewMatrix,transformChildY); 

            //sterring
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.05,0.2,0.3]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[11,0,0]);  
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================

            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,redColors);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            //seatsandar
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.1,0.5,0.4]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[14.5,0,0]);  
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            //==================================================================

            modelViewMatrix = mat4.create(); 
            var colorsBuffer = initBuffers(gl,positionsBox,greyColors2);
            mat4.translate(modelViewMatrix,modelViewMatrix,[pMoveX,pMoveY,pMoveZ]);  
            mat4.rotateX(modelViewMatrix,modelViewMatrix,rotateX);   
            mat4.rotateY(modelViewMatrix,modelViewMatrix,rotateY);  
            mat4.rotateZ(modelViewMatrix,modelViewMatrix,rotateZ);

            //seatduduk
            mat4.scale(modelViewMatrix,modelViewMatrix,[0.5,0.1,0.4]);
            mat4.translate(modelViewMatrix,modelViewMatrix,[2.1,-5,0]);  
            drawScene(gl, programInfo, colorsBuffer, modelViewMatrix, projectionMatrix);
            gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);

            var redColors2 = [ 
                [0.990, 0, 0.5, 1.0],    
                [0.990, 0, 0.5, 1.0],   
                [0.880, 0, 0.5, 1.0],   
                [0.880, 0, 0.5, 1.0],  
                [0.770, 0, 0.5, 1.0],
                [0.770, 0, 0.5, 1.0],
            ];
            colorsBuffer = initBuffers(gl,positionsBox,redColors2);

            var greenColors2 = [ 
                [0, 0.990, 0.990, 1.0],    
                [0, 0.990, 0.990, 1.0],   
                [0, 0.880, 0.880, 1.0],   
                [0, 0.880, 0.880, 1.0],   
                [0, 0.770, 0.770, 1.0],   
                [0, 0.770, 0.770, 1.0],   
            ];
            colorsBuffer = initBuffers(gl,positionsBox,greenColors2);

        }
        
        var YellowColors = [
            [1.500, 0.5, 0, 0.5],
            [1.500, 0.5, 0, 0.5],
            [1.480, 0.7, 0, 1],
            [1.480, 0.7, 0, 1],
            [1.370, 0.4, 0, 1],
            [1.370, 0.4, 0, 1],
        ];

        var darkblueColors = [
            [0.0126, 0.115, 0.630, 1.0],
            [0.0126, 0.115, 0.630, 1.0],
            [0.0126, 0.115, 0.630, 1.0],
            [0.0126, 0.115, 0.630, 1.0],
            [0.0126, 0.115, 0.630, 1.0],
            [0.0126, 0.115, 0.630, 1.0],
        ];

        var lightblueColors = [
            [1.500, 0.5, 0, 0.5],
            [1.500, 0.5, 0, 0.5],
            [1.480, 0.7, 0, 1],
            [1.480, 0.7, 0, 1],
            [1.370, 0.4, 0, 1],
            [1.370, 0.4, 0, 1],

        ];

        // Array for variance of YellowColors
        var blueColors = [
            [0.0, 0.0, 1.0, 1.0],
            [0.0, 0.0, 1.0, 1.0],
            [0.0, 0.0, 1.0, 1.0],
            [0.0, 0.0, 1.0, 1.0],
            [0.0, 0.0, 1.0, 1.0],
            [0.0, 0.0, 1.0, 1.0],
        ];

        var greyColors = [ 
            [0.6,  0.6,  0.6, 1.0],    
            [0.6,  0.6,  0.6, 1.0],    
            [0.7,  0.7,  0.7, 1.0],    
            [0.7,  0.7,  0.7, 1.0],      
            [0.8,  0.8,  0.8, 1.0],   
            [0.8,  0.8,  0.8, 1.0],   
        ];

        var greenColors = [ 
            [0, 0.990, 0.990, 1.0],    
            [0, 0.990, 0.990, 1.0],   
            [0, 0.880, 0.880, 1.0],   
            [0, 0.880, 0.880, 1.0],   
            [0, 0.770, 0.770, 1.0],   
            [0, 0.770, 0.770, 1.0],   
        ];

        var redColors = [ 
            [0.990, 0, 0.5, 1.0],    
            [0.990, 0, 0.5, 1.0],   
            [0.880, 0, 0.5, 1.0],   
            [0.880, 0, 0.5, 1.0],  
            [0.770, 0, 0.5, 1.0],
            [0.770, 0, 0.5, 1.0],
        ];

        var rotateX = 0, rotateY = 0, rotateZ = 0;


        var prevx, prevy, canvas;
        var dragging = false;

        function doMouseDown(evt) {
            if (dragging)
                return;
            dragging = true;
            document.addEventListener("mousemove", doMouseDrag, false);
            document.addEventListener("mouseup", doMouseUp, false);
            var box = canvas.getBoundingClientRect();
            prevx = window.pageXOffset + evt.clientX - box.left;
            prevy = window.pageYOffset + evt.clientY - box.top;
        }

        function doMouseDrag(evt) {
            if (!dragging)
                return;
            var box = canvas.getBoundingClientRect();
            var x = window.pageXOffset + evt.clientX - box.left;
            var y = window.pageYOffset + evt.clientY - box.top;
            let diffy = (prevx - x) * 0.01;
            let diffx = (prevy - y) * 0.01;
            prevx = x;
            prevy = y;
            rotateX = rotateX - diffx;
            rotateY = rotateY - diffy;
            main();
        }
        
        function doMouseUp(evt) {
            if (dragging) {
                document.removeEventListener("mousemove", doMouseDrag, false);
                document.removeEventListener("mouseup", doMouseUp, false);
                dragging = false;
            }
        }
        
        function resetRotation() {
            rotateX = 0, rotateY = 0, rotateZ = 0;
            main();
        }

        
        window.onload = main;


        function initBuffers(gl,positions,faceColors) {


            const positionBuffer = gl.createBuffer();


            gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);


            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);

  
            const normalBuffer = gl.createBuffer();
            gl.bindBuffer(gl.ARRAY_BUFFER, normalBuffer);


            const vertexNormals = [

                0.0,  0.0,  1.0,
                0.0,  0.0,  1.0,
                0.0,  0.0,  1.0,
                0.0,  0.0,  1.0,

                
                0.0,  0.0, -1.0,
                0.0,  0.0, -1.0,
                0.0,  0.0, -1.0,
                0.0,  0.0, -1.0,

                
                0.0,  1.0,  0.0,
                0.0,  1.0,  0.0,
                0.0,  1.0,  0.0,
                0.0,  1.0,  0.0,

               
                0.0, -1.0,  0.0,
                0.0, -1.0,  0.0,
                0.0, -1.0,  0.0,
                0.0, -1.0,  0.0,

               
                1.0,  0.0,  0.0,
                1.0,  0.0,  0.0,
                1.0,  0.0,  0.0,
                1.0,  0.0,  0.0,

                
                -1.0,  0.0,  0.0,
                -1.0,  0.0,  0.0,
                -1.0,  0.0,  0.0,
                -1.0,  0.0,  0.0
            ];

            
            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertexNormals), gl.STATIC_DRAW);

                           
            var colors = [];

            for (var j = 0; j < faceColors.length; ++j) {
                const c = faceColors[j];
                colors = colors.concat(c, c, c, c);
            }

            const colorBuffer = gl.createBuffer();
            gl.bindBuffer(gl.ARRAY_BUFFER, colorBuffer);
            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(colors), gl.STATIC_DRAW);

            
            const indexBuffer = gl.createBuffer();
            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);

            
            const indices = [
                0,  1,  2,      0,  2,  3,    // front
                4,  5,  6,      4,  6,  7,    // back
                8,  9,  10,     8,  10, 11,   // top
                12, 13, 14,     12, 14, 15,   // bottom
                16, 17, 18,     16, 18, 19,   // right
                20, 21, 22,     20, 22, 23,   // left
            ];

            

            gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);

            return {
                position: positionBuffer,
                normal: normalBuffer, // 
                color: colorBuffer,
                indices: indexBuffer,
            };
        }

        
        function drawScene(gl, programInfo, buffers, modelViewMatrix, projectionMatrix) {
            
            {
                const numComponents = 3; 
                const type = gl.FLOAT;
                const normalize = false;
                const stride = 0;
                const offset = 0;
                gl.bindBuffer(gl.ARRAY_BUFFER, buffers.position);
                gl.vertexAttribPointer(
                    programInfo.attribLocations.vertexPosition,
                    numComponents,
                    type,
                    normalize,
                    stride,
                    offset);
                gl.enableVertexAttribArray(
                    programInfo.attribLocations.vertexPosition);
            }

            
            {
                const numComponents = 4; // (r,g,b,a)
                const type = gl.FLOAT;
                const normalize = false;
                const stride = 0;
                const offset = 0;
                gl.bindBuffer(gl.ARRAY_BUFFER, buffers.color);
                gl.vertexAttribPointer(
                    programInfo.attribLocations.vertexColor,
                    numComponents,
                    type,
                    normalize,
                    stride,
                    offset);
                gl.enableVertexAttribArray(
                    programInfo.attribLocations.vertexColor);
            }

            
            var normalMatrix = mat4.create();
            mat4.invert(normalMatrix, modelViewMatrix);
            mat4.transpose(normalMatrix, normalMatrix);

            
            {
                const numComponents = 3; // 
                const type = gl.FLOAT;
                const normalize = false;
                const stride = 0;
                const offset = 0;
                gl.bindBuffer(gl.ARRAY_BUFFER, buffers.normal);
                gl.vertexAttribPointer(
                    programInfo.attribLocations.vertexNormal,
                    numComponents,
                    type,
                    normalize,
                    stride,
                    offset);
                gl.enableVertexAttribArray(
                    programInfo.attribLocations.vertexNormal);
            }    
            
            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffers.indices);

            
            gl.useProgram(programInfo.program);

            
            gl.uniformMatrix4fv(
                programInfo.uniformLocations.projectionMatrix,
                false,
                projectionMatrix);
            gl.uniformMatrix4fv(
                programInfo.uniformLocations.modelViewMatrix,
                false,
                modelViewMatrix);

             
            gl.uniformMatrix4fv(
                programInfo.uniformLocations.normalMatrix,
                false,
                normalMatrix);
        }

        
        function initShaderProgram(gl, vsSource, fsSource) {
            const vertexShader = loadShader(gl, gl.VERTEX_SHADER, vsSource);
            const fragmentShader = loadShader(gl, gl.FRAGMENT_SHADER, fsSource);

            
            const shaderProgram = gl.createProgram();
            gl.attachShader(shaderProgram, vertexShader);
            gl.attachShader(shaderProgram, fragmentShader);
            gl.linkProgram(shaderProgram);

            
            if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {
                alert('Unable to initialize the shader program: ' + gl.getProgramInfoLog(shaderProgram));
                return null;
            }

            return shaderProgram;
        }

        
        function loadShader(gl, type, source) {
            const shader = gl.createShader(type);

            
            gl.shaderSource(shader, source);

            
            gl.compileShader(shader);

            
            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
                alert('An error occurred compiling the shaders: ' + gl.getShaderInfoLog(shader));
                gl.deleteShader(shader);
                return null;
            }

            return shader;
        }

        var transformChildY = 0, transformGrandZ = 0;
        var rotationSpeed = 1, transparencyValue = 1;
        var translateZ = 0, scaleY = 1, rotateObject = 0;

        

        var pMoveX = 0, pMoveY = 0, pMoveZ = 0;
        var cMoveX = 0, cMoveY = 1, cMoveZ = 10;

        function changeP1value() {
            pMoveX = document.getElementById("p1Value").value;
            document.getElementById("pMoveX").innerHTML = document.getElementById("p1Value").value;
            main(); 
        }

        function changeC1value() {
            cMoveX = document.getElementById("c1Value").value;
            document.getElementById("cMoveX").innerHTML = document.getElementById("c1Value").value;
            main(); 
        }

        function changeP2value() {
            pMoveY = document.getElementById("p2Value").value;
            document.getElementById("pMoveY").innerHTML = document.getElementById("p2Value").value;
            main(); 
        }

        function changeC2value() {
            cMoveY = document.getElementById("c2Value").value;
            document.getElementById("cMoveY").innerHTML = document.getElementById("c2Value").value;
            main(); 
        }

        function changeP3value() {
            pMoveZ = document.getElementById("p3Value").value;
            document.getElementById("pMoveZ").innerHTML = document.getElementById("p3Value").value;
            main(); 
        }

        function changeC3value() {
            cMoveZ = document.getElementById("c3Value").value;
            document.getElementById("cMoveZ").innerHTML = document.getElementById("c3Value").value;
            main(); 
        }


        

        var transformGrandBool = false, transformChildBool = false;
        var timerGrand = 0, timerChild = 0;

        
        function transformGrand() {
            if (transformGrandBool == false) { transformGrandBool = true; }
            else { transformGrandBool = false; }

            if (transformGrandBool == true) {
                timerGrand = setInterval(function(){ transformGrandLoop() }, 10);
                document.getElementById("grandBtn").value = "Stop (GRANDCHILD)";
            } else {
                clearInterval(timerGrand);
                document.getElementById("grandBtn").value = "GRANDCHILD";
            }
        }

        
        function transformGrandLoop() {
            transformGrandZ = transformGrandZ + (rotationSpeed * 0.0174533);
            main();
        }

        
        function transformChild() {
            if (transformChildBool == false) { transformChildBool = true; }
            else { transformChildBool = false; }

            if (transformChildBool == true) {
                timerChild = setInterval(function(){ transformChildLoop() }, 10);
                document.getElementById("childBtn").value = "Stop (CHILD)";
            } else {
                clearInterval(timerChild);
                document.getElementById("childBtn").value = "CHILD";
            }
        }


        
        var rotateClockwise = false;
        function transformChildLoop() {

            if (rotateClockwise == true) {
                transformChildY = transformChildY - (0.3 * 0.0174533);
                if (transformChildY < -0.05) {
                    rotateClockwise = false;
                } 
            } else {
                transformChildY = transformChildY + (0.3 * 0.0174533);
                if (transformChildY > 0.05) {
                    rotateClockwise = true;
                } 
            }
            main();
        }

        

        
        function changeS1value() {
             
            rotationSpeed = document.getElementById("s1Value").value;
            
            document.getElementById("speedValue").innerHTML = document.getElementById("s1Value").value;
            
            transformGrandLoop(); 
        }

        

        var colorGrandBool = false, colorChildBool = false;

        
        function colorGrand() {
            if (colorGrandBool == false) { colorGrandBool = true; }
            else { colorGrandBool = false; }

            if (colorGrandBool == true) {
                YellowColors = [ 
                    [1, 1, 1, transparencyValue],    
                    [1, 1, 1, transparencyValue],  
                    [1, 1, 1, transparencyValue],  
                    [1, 1, 1, transparencyValue],  
                    [1, 1, 1, transparencyValue],  
                    [1, 1, 1, transparencyValue],  
                ];
                document.getElementById("grandBtn2").value = "Revert (GRANDCHILD)";
            } else {
                YellowColors = [ 
                    [1.500, 0.5, 0, transparencyValue],
                    [1.500, 0.5, 0, transparencyValue],
                    [1.480, 0.7, 0, transparencyValue],
                    [1.480, 0.7, 0, transparencyValue],
                    [1.370, 0.4, 0, transparencyValue],
                    [1.370, 0.4, 0, transparencyValue], 
                ];
                document.getElementById("grandBtn2").value = "GRANDCHILD";
            }

            main();
        }

        
        function colorChild() {
            if (colorChildBool == false) { colorChildBool = true; }
            else { colorChildBool = false; }

            if (colorChildBool == true) {
                greyColors = [ 
                    [0, 0, 0.990, 1.0],    
                    [0, 0, 0.990, 1.0],  
                    [0, 0, 0.880, 1.0],  
                    [0, 0, 0.880, 1.0],  
                    [0, 0, 0.770, 1.0],  
                    [0, 0, 0.770, 1.0],   
                ];
                document.getElementById("childBtn2").value = "Revert (CHILD)";
            } else {
                greyColors = [ 
                    [0.6,  0.6,  0.6, 1.0],    
                    [0.6,  0.6,  0.6, 1.0],    
                    [0.7,  0.7,  0.7, 1.0],    
                    [0.7,  0.7,  0.7, 1.0],      
                    [0.8,  0.8,  0.8, 1.0],   
                    [0.8,  0.8,  0.8, 1.0],    
                ];
                document.getElementById("childBtn2").value = "CHILD";
            }

            main();
        }

        
        function changeS2value() {
            
            transparencyValue = document.getElementById("s2Value").value / 10;
            
            document.getElementById("alphaValue").innerHTML = transparencyValue;
            
            if (colorGrandBool == false) { colorGrandBool = true; }
            else { colorGrandBool = false; }
            colorGrand();
        }

    </script>
</head>

<body style="font-family: Arial, Helvetica, sans-serif; text-align: center;">
    <div style="padding: 10px 0px 10px 0px;">
        <div style="padding-bottom:7px; font-size:0.8em;">Drag mouse inside canvas to rotate PARENT on x-axis and y-axis</div>
        <input type="button" style="margin:1px; width:23%;" id="resetBtn" value="Reset rotation" onclick="resetRotation()">
    </div>
    <canvas id="glCanvas" width="640" height="480"></canvas>
    <br><br>
    <table width="640" cellpadding="0" cellspacing="5" border="0" align="center">
        <tr>
            <td align="center" style="font-size:0.8em;">PARENT movement (x-axis): <span id="pMoveX">0</span>
                <input oninput="changeP1value()" id="p1Value" type="range" min="-10" max="10" value="0" style="width: 100%"></td>
            <td rowspan="3" width="5%" style="border-right: 1px dashed #999;"></td>
            <td rowspan="3" width="3%"></td>
            <td align="center" style="font-size:0.8em;">CAMERA movement (x-axis): <span id="cMoveX">0</span>
                <input oninput="changeC1value()" id="c1Value" type="range" min="-10" max="10" value="0" style="width: 100%"></td>
        </tr>
        <tr>
            <td align="center" style="font-size:0.8em;">PARENT movement (y-axis): <span id="pMoveY">0</span>
                <input oninput="changeP2value()" id="p2Value" type="range" min="-10" max="10" value="0" style="width: 100%"></td>
            <td align="center" style="font-size:0.8em;">CAMERA movement (y-axis): <span id="cMoveY">1</span>
                <input oninput="changeC2value()" id="c2Value" type="range" min="-10" max="10" value="1" style="width: 100%"></td>
        </tr>
        <tr>
            <td align="center" style="font-size:0.8em;">PARENT movement (z-axis): <span id="pMoveZ">0</span>
                <input oninput="changeP3value()" id="p3Value" type="range" min="-10" max="10" value="0" style="width: 100%"></td>
            <td align="center" style="font-size:0.8em;">CAMERA movement (z-axis): <span id="cMoveZ">10</span>
                <input oninput="changeC3value()" id="c3Value" type="range" min="-10" max="10" value="10" style="width: 100%"></td>
        </tr>
    </table>
    <table width="640" cellpadding="0" cellspacing="5" border="0" align="center">
        <tr><td colspan="2"><hr></td></tr>
        <tr>
            <td width="40%" align="right">Perform transformation: </td>
            <td>
                <input type="button" style="margin:5px; width:45%;" id="childBtn" value="CHILD" onclick="transformChild()">
                <input type="button" style="margin:5px; width:45%;" id="grandBtn" value="GRANDCHILD" onclick="transformGrand()">
            </td>
        </tr>
        <tr>
            <td align="right" style="font-size:0.8em;">GRANDCHILD transformation speed: <span id="speedValue">1</span></td>
            <td><input oninput="changeS1value()" id="s1Value" type="range" min="1" max="10" value="0" style="width: 100%"></td>
        </tr>
        <tr><td colspan="2"><hr></td></tr>
        <tr>
            <td align="right">Change color: </td>
            <td>
                <input type="button" style="margin:5px; width:45%;" id="childBtn2" value="CHILD" onclick="colorChild()">
                <input type="button" style="margin:5px; width:45%;" id="grandBtn2" value="GRANDCHILD" onclick="colorGrand()">
            </td>
        </tr>
        <tr>
            <td align="right" style="font-size:0.8em;">GRANDCHILD alpha value: <span id="alphaValue">1</span></td>
            <td><input oninput="changeS2value()" id="s2Value" type="range" min="0" max="10" value="10" style="width: 100%"></td>
        </tr>
    </table>
</body>